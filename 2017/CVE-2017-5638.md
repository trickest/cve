### [CVE-2017-5638](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20Struts&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

The Jakarta Multipart parser in Apache Struts 2 2.3.x before 2.3.32 and 2.5.x before 2.5.10.1 has incorrect exception handling and error-message generation during file-upload attempts, which allows remote attackers to execute arbitrary commands via a crafted Content-Type, Content-Disposition, or Content-Length HTTP header, as exploited in the wild in March 2017 with a Content-Type header containing a #cmd= string.

### POC

#### Reference
- http://blog.talosintelligence.com/2017/03/apache-0-day-exploited.html
- http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-5638-apache-struts-vulnerability-remote-code-execution/
- http://www.oracle.com/technetwork/security-advisory/cpujul2017-3236622.html
- https://github.com/rapid7/metasploit-framework/issues/8064
- https://packetstormsecurity.com/files/141494/S2-45-poc.py.txt
- https://www.exploit-db.com/exploits/41614/

#### Github
- https://github.com/0day666/Vulnerability-verification
- https://github.com/0x00-0x00/CVE-2017-5638
- https://github.com/3vikram/Application-Vulnerabilities-Payloads
- https://github.com/84KaliPleXon3/Payloads_All_The_Things
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Aasron/Struts2-045-Exp
- https://github.com/AndreaOm/awesome-stars
- https://github.com/AndreasKl/CVE-2017-5638
- https://github.com/Cyberleet1337/Payloadswebhack
- https://github.com/Delishsploits/PayloadsAndMethodology
- https://github.com/DynamicDesignz/Alien-Framework
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/Flyteas/Struts2-045-Exp
- https://github.com/Greynad/struts2-jakarta-inject
- https://github.com/GuynnR/Payloads
- https://github.com/H0j3n/EzpzCheatSheet
- https://github.com/Iletee/struts2-rce
- https://github.com/Kaizhe/attacker
- https://github.com/KarzsGHR/S2-046_S2-045_POC
- https://github.com/Masahiro-Yamada/OgnlContentTypeRejectorValve
- https://github.com/Muhammd/Awesome-Payloads
- https://github.com/NCSU-DANCE-Research-Group/CDL
- https://github.com/Nieuport/PayloadsAllTheThings
- https://github.com/PWN-Kingdom/Test_Tasks
- https://github.com/PolarisLab/S2-045
- https://github.com/Prodject/Kn0ck
- https://github.com/Pwera/Anchore-Notes
- https://github.com/R4v3nBl4ck/Apache-Struts-2-CVE-2017-5638-Exploit-
- https://github.com/Ra7mo0on/PayloadsAllTheThings
- https://github.com/SexyBeast233/SecBooks
- https://github.com/Soldie/PayloadsAllTheThings
- https://github.com/SpiderMate/Stutsfi
- https://github.com/SunatP/FortiSIEM-Incapsula-Parser
- https://github.com/XPR1M3/Payloads_All_The_Things
- https://github.com/Xhendos/CVE-2017-5638
- https://github.com/albinowax/ActiveScanPlusPlus
- https://github.com/aljazceru/CVE-2017-5638-Apache-Struts2
- https://github.com/alphaSeclab/sec-daily-2019
- https://github.com/andrewkroh/auditbeat-apache-struts-demo
- https://github.com/andrysec/PayloadsAllVulnerability
- https://github.com/anhtu97/PayloadAllEverything
- https://github.com/apkadmin/PayLoadsAll
- https://github.com/aylincetin/PayloadsAllTheThings
- https://github.com/bhagdave/CVE-2017-5638
- https://github.com/bibortone/Jexboss
- https://github.com/bongbongco/cve-2017-5638
- https://github.com/c002/Apache-Struts
- https://github.com/c002/Java-Application-Exploits
- https://github.com/cafnet/apache-struts-v2-CVE-2017-5638
- https://github.com/chanchalpatra/payload
- https://github.com/donaldashdown/Common-Vulnerability-and-Exploit
- https://github.com/eeehit/CVE-2017-5638
- https://github.com/eescanilla/Apache-Struts-v3
- https://github.com/evolvesecurity/vuln-struts2-vm
- https://github.com/falcon-lnhg/StrutsShell
- https://github.com/fupinglee/Struts2_Bugs
- https://github.com/ggolawski/struts-rce
- https://github.com/gmu-swe/rivulet
- https://github.com/gobysec/Goby
- https://github.com/gsfish/S2-Reaper
- https://github.com/hacking-kubernetes/hacking-kubernetes.info
- https://github.com/hellochunqiu/PayloadsAllTheThings
- https://github.com/hktalent/myhktools
- https://github.com/homjxi0e/CVE-2017-5638
- https://github.com/hook-s3c/CVE-2018-11776-Python-PoC
- https://github.com/immunio/apache-struts2-CVE-2017-5638
- https://github.com/initconf/CVE-2017-5638_struts
- https://github.com/invisiblethreat/strutser
- https://github.com/jas502n/S2-045-EXP-POC-TOOLS
- https://github.com/jas502n/st2-046-poc
- https://github.com/joaomatosf/jexboss
- https://github.com/jpacora/Struts2Shell
- https://github.com/jrrdev/cve-2017-5638
- https://github.com/jrrombaldo/CVE-2017-5638
- https://github.com/kk98kk0/Payloads
- https://github.com/ksw9722/PayloadsAllTheThings
- https://github.com/kyawthiha7/pentest-methodology
- https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit
- https://github.com/lizhi16/CVE-2017-5638
- https://github.com/lolwaleet/ExpStruts
- https://github.com/m3ssap0/struts2_cve-2017-5638
- https://github.com/mazen160/struts-pwn
- https://github.com/mcassano/cve-2017-5638
- https://github.com/mike-williams/Struts2Vuln
- https://github.com/milkdevil/jexboss
- https://github.com/mrhacker51/ReverseShellCommands
- https://github.com/mthbernardes/strutszeiro
- https://github.com/nevidimk0/PayloadsAllTheThings
- https://github.com/nightfallai/pii-leak-prevention-guide
- https://github.com/nixawk/labs
- https://github.com/oktavianto/CVE-2017-5638-Apache-Struts2
- https://github.com/oneplus-x/MS17-010
- https://github.com/oneplus-x/Sn1per
- https://github.com/opt9/Strutscli
- https://github.com/opt9/Strutshock
- https://github.com/ozkanbilge/Payloads
- https://github.com/paralelo14/CVE_2017_5638
- https://github.com/paralelo14/google_explorer
- https://github.com/payatu/CVE-2017-5638
- https://github.com/pr0x1ma-byte/cybersecurity-struts2
- https://github.com/pr0x1ma-byte/cybersecurity-struts2-send
- https://github.com/pthiagu2/Security-multi-stage-data-analysis
- https://github.com/qazbnm456/awesome-cve-poc
- https://github.com/random-robbie/CVE-2017-5638
- https://github.com/rebujacker/CVEPoCs
- https://github.com/ret2jazzy/Struts-Apache-ExploitPack
- https://github.com/riyazwalikar/struts-rce-cve-2017-5638
- https://github.com/s1kr10s/Apache-Struts-v4
- https://github.com/sUbc0ol/Apache-Struts-CVE-2017-5638-RCE-Mass-Scanner
- https://github.com/sUbc0ol/Apache-Struts2-RCE-Exploit-v2-CVE-2017-5638
- https://github.com/samba234/Sniper
- https://github.com/samuelproject/ApacheStruts2
- https://github.com/shawnmckinney/remote-code-execution-sample
- https://github.com/sjitech/test_struts2_vulnerability_CVE-2017-5638
- https://github.com/sobinge/--1
- https://github.com/sobinge/PayloadsAllTheThings
- https://github.com/sobinge/PayloadsAllThesobinge
- https://github.com/sobinge/nuclei-templates
- https://github.com/tahmed11/strutsy
- https://github.com/tdcoming/Vulnerability-engine
- https://github.com/trapp3rhat/CVE-shellshock
- https://github.com/tsheth/JavaStruts-App-Terraform
- https://github.com/unusualwork/Sn1per
- https://github.com/wangeradd1/MyPyExploit
- https://github.com/whoadmin/pocs
- https://github.com/win3zz/CVE-2017-5638
- https://github.com/winterwolf32/PayloadsAllTheThings
- https://github.com/woods-sega/woodswiki
- https://github.com/xbl3/awesome-cve-poc_qazbnm456
- https://github.com/xsscx/cve-2017-5638
- https://github.com/zema1/oracle-vuln-crawler

