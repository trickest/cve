### [CVE-2023-2283](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2283)
![](https://img.shields.io/static/v1?label=Product&message=libssh&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=libssh-2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-287&color=brightgreen)

### Description

A vulnerability was found in libssh, where the authentication check of the connecting client can be bypassed in the`pki_verify_data_signature` function in memory allocation problems. This issue may happen if there is insufficient memory or the memory usage is limited. The problem is caused by the return value `rc,` which is initialized to SSH_ERROR and later rewritten to save the return value of the function call `pki_key_check_hash_compatible.` The value of the variable is not changed between this point and the cryptographic verification. Therefore any error between them calls `goto error` returning SSH_OK.

### POC

#### Reference
- http://packetstormsecurity.com/files/172861/libssh-0.9.6-0.10.4-pki_verify_data_signature-Authorization-Bypass.html

#### Github
- https://github.com/GitHubSecurityLab/seclab-taskflow-agent
- https://github.com/OSS-SASM/RhsaCveScanner
- https://github.com/fkie-cad/nvd-json-data-feeds

