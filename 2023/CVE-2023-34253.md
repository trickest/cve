### [CVE-2023-34253](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34253)
![](https://img.shields.io/static/v1?label=Product&message=grav&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.7.42%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-1336%3A%20Improper%20Neutralization%20of%20Special%20Elements%20Used%20in%20a%20Template%20Engine&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-184%3A%20Incomplete%20List%20of%20Disallowed%20Inputs&color=brightgreen)

### Description

Grav is a flat-file content management system. Prior to version 1.7.42, the denylist introduced in commit 9d6a2d to prevent dangerous functions from being executed via injection of malicious templates was insufficient and could be easily subverted in multiple ways -- (1) using unsafe functions that are not banned, (2) using capitalised callable names, and (3) using fully-qualified names for referencing callables. Consequently, a low privileged attacker with login access to Grav Admin panel and page creation/update permissions is able to inject malicious templates to obtain remote code execution. A patch in version 1.7.42 improves the denylist.

### POC

#### Reference
- https://huntr.dev/bounties/3ef640e6-9e25-4ecb-8ec1-64311d63fe66/

#### Github
No PoCs found on GitHub currently.

