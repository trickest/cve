### [CVE-2023-27487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-27487)
![](https://img.shields.io/static/v1?label=Product&message=envoy&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.22.9%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.23.0%2C%20%3C%201.23.6%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.24.0%2C%20%3C%201.24.4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%201.25.0%2C%20%3C1.25.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-20%3A%20Improper%20Input%20Validation&color=brightgreen)

### Description

Envoy is an open source edge and service proxy designed for cloud-native applications. Prior to versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9, the client may bypass JSON Web Token (JWT) checks and forge fake original paths. The header `x-envoy-original-path` should be an internal header, but Envoy does not remove this header from the request at the beginning of request processing when it is sent from an untrusted client. The faked header would then be used for trace logs and grpc logs, as well as used in the URL used for `jwt_authn` checks if the `jwt_authn` filter is used, and any other upstream use of the x-envoy-original-path header. Attackers may forge a trusted `x-envoy-original-path` header. Versions 1.26.0, 1.25.3, 1.24.4, 1.23.6, and 1.22.9 have patches for this issue.

### POC

#### Reference
- https://github.com/envoyproxy/envoy/security/advisories/GHSA-5375-pq35-hf2g

#### Github
No PoCs found on GitHub currently.

