### [CVE-2023-31128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31128)
![](https://img.shields.io/static/v1?label=Product&message=cookbook&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=main-0.9.x%20%3C%20489bb744%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=master%20%3C%20a46d9855%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-78%3A%20Improper%20Neutralization%20of%20Special%20Elements%20used%20in%20an%20OS%20Command%20('OS%20Command%20Injection')&color=brightgreen)

### Description

NextCloud Cookbook is a recipe library app. Prior to commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch, the `pull-checks.yml` workflow is vulnerable to command injection attacks because of using an untrusted `github.head_ref` field. The `github.head_ref` value is an attacker-controlled value. Assigning the value to `zzz";echo${IFS}"hello";#` can lead to command injection. Since the permission is not restricted, the attacker has a write-access to the repository. This issue is fixed in commit a46d9855 on the `master` branch and commit 489bb744 on the `main-0.9.x` branch. There is no risk for the user of the app within the NextCloud server. This only affects the main repository and possible forks of it. Those who have forked the NextCloud Cookbook repository should make sure their forks are on the latest version to prevent code injection attacks and similar.

### POC

#### Reference
- https://github.com/nextcloud/cookbook/security/advisories/GHSA-c5pc-mf2f-xq8h
- https://securitylab.github.com/research/github-actions-untrusted-input/

#### Github
No PoCs found on GitHub currently.

