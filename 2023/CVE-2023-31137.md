### [CVE-2023-31137](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31137)
![](https://img.shields.io/static/v1?label=Product&message=MaraDNS&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%3D%203.5.0024%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-191%3A%20Integer%20Underflow%20(Wrap%20or%20Wraparound)&color=brightgreen)

### Description

MaraDNS is open-source software that implements the Domain Name System (DNS). In version 3.5.0024 and prior, a remotely exploitable integer underflow vulnerability in the DNS packet decompression function allows an attacker to cause a Denial of Service by triggering an abnormal program termination.The vulnerability exists in the `decomp_get_rddata` function within the `Decompress.c` file. When handling a DNS packet with an Answer RR of qtype 16 (TXT record) and any qclass, if the `rdlength` is smaller than `rdata`, the result of the line `Decompress.c:886` is a negative number `len = rdlength - total;`. This value is then passed to the `decomp_append_bytes` function without proper validation, causing the program to attempt to allocate a massive chunk of memory that is impossible to allocate. Consequently, the program exits with an error code of 64, causing a Denial of Service.One proposed fix for this vulnerability is to patch `Decompress.c:887` by breaking `if(len <= 0)`, which has been incorporated in version 3.5.0036 via commit bab062bde40b2ae8a91eecd522e84d8b993bab58.

### POC

#### Reference
- https://github.com/samboy/MaraDNS/security/advisories/GHSA-58m7-826v-9c3c

#### Github
No PoCs found on GitHub currently.

