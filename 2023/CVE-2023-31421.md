### [CVE-2023-31421](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31421)
![](https://img.shields.io/static/v1?label=Product&message=APM%20Server&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Beats&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Elastic%20Agent&color=blue)
![](https://img.shields.io/static/v1?label=Product&message=Fleet%20Server&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=8.0.0%2C%208.9.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-295%3A%20Improper%20Certificate%20Validation&color=brightgreen)

### Description

It was discovered that when acting as TLS clients, Beats, Elastic Agent, APM Server, and Fleet Server did not verify whether the server certificate is valid for the target IP address; however, certificate signature validation is still performed. More specifically, when the client is configured to connect to an IP address (instead of a hostname) it does not validate the server certificate's IP SAN values against that IP address and certificate validation fails, and therefore the connection is not blocked as expected.

### POC

#### Reference
- https://www.elastic.co/community/security

#### Github
No PoCs found on GitHub currently.

