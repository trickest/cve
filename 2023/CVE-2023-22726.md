### [CVE-2023-22726](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-22726)
![](https://img.shields.io/static/v1?label=Product&message=act&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%200.2.40%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-434%3A%20Unrestricted%20Upload%20of%20File%20with%20Dangerous%20Type&color=brightgreen)

### Description

act is a project which allows for local running of github actions. The artifact server that stores artifacts from Github Action runs does not sanitize path inputs. This allows an attacker to download and overwrite arbitrary files on the host from a Github Action. This issue may lead to privilege escalation. The /upload endpoint is vulnerable to path traversal as filepath is user controlled, and ultimately flows into os.Mkdir and os.Open. The /artifact endpoint is vulnerable to path traversal as the path is variable is user controlled, and the specified file is ultimately returned by the server. This has been addressed in version 0.2.40. Users are advised to upgrade. Users unable to upgrade may, during implementation of Open and OpenAtEnd for FS, ensure to use ValidPath() to check against path traversal or clean the user-provided paths manually.

### POC

#### Reference
- https://github.com/nektos/act/security/advisories/GHSA-pc99-qmg4-rcff
- https://securitylab.github.com/advisories/GHSL-2023-004_act/

#### Github
- https://github.com/ProxyPog/POC-CVE-2023-22726
- https://github.com/nomi-sec/PoC-in-GitHub

