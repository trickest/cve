### [CVE-2023-34105](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34105)
![](https://img.shields.io/static/v1?label=Product&message=srs&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%205.0-b1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%205.0.137%2C%20%3C%205.0.157%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%206.0.18%2C%20%3C%206.0.48%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-78%3A%20Improper%20Neutralization%20of%20Special%20Elements%20used%20in%20an%20OS%20Command%20('OS%20Command%20Injection')&color=brightgreen)

### Description

SRS is a real-time video server supporting RTMP, WebRTC, HLS, HTTP-FLV, SRT, MPEG-DASH, and GB28181. Prior to versions 5.0.157, 5.0-b1, and 6.0.48, SRS's `api-server` server is vulnerable to a drive-by command injection. An attacker may send a request to the `/api/v1/snapshots` endpoint containing any commands to be executed as part of the body of the POST request. This issue may lead to Remote Code Execution (RCE). Versions 5.0.157, 5.0-b1, and 6.0.48 contain a fix.

### POC

#### Reference
- https://github.com/ossrs/srs/security/advisories/GHSA-vpr5-779c-cx62

#### Github
- https://github.com/20142995/nuclei-templates
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/cyb3r-w0lf/nuclei-template-collection

