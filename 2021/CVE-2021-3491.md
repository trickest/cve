### [CVE-2021-3491](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3491)
![](https://img.shields.io/static/v1?label=Product&message=Linux%20kernel&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=linux-5.10.y%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=linux-5.11.y%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=linux-5.12.y%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=trunk%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=v5.7-rc1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-131%20Incorrect%20Calculation%20of%20Buffer%20Size&color=brightgreen)

### Description

The io_uring subsystem in the Linux kernel allowed the MAX_RW_COUNT limit to be bypassed in the PROVIDE_BUFFERS operation, which led to negative values being usedin mem_rw when reading /proc/<PID>/mem. This could be used to create a heap overflow leading to arbitrary code execution in the kernel. It was addressed via commit d1f82808877b ("io_uring: truncate lengths larger than MAX_RW_COUNT on provide buffers") (v5.13-rc1) and backported to the stable kernels in v5.12.4, v5.11.21, and v5.10.37. It was introduced in ddf0322db79c ("io_uring: add IORING_OP_PROVIDE_BUFFERS") (v5.7-rc1).

### POC

#### Reference
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d1f82808877bb10d3deee7cf3374a4eb3fb582db
- https://ubuntu.com/security/notices/USN-4949-1
- https://ubuntu.com/security/notices/USN-4950-1

#### Github
No PoCs found on GitHub currently.

