### [CVE-2021-3939](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3939)
![](https://img.shields.io/static/v1?label=Product&message=accountsservice&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=0.6.55-0ubuntu12~20.04%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0.6.55-0ubuntu13%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0.6.55-0ubuntu14%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-590%20Free%20of%20Memory%20not%20on%20the%20Heap&color=brightgreen)

### Description

Ubuntu-specific modifications to accountsservice (in patch file debian/patches/0010-set-language.patch) caused the fallback_locale variable, pointing to static storage, to be freed, in the user_change_language_authorized_cb function. This is reachable via the SetLanguage dbus function. This is fixed in versions 0.6.55-0ubuntu12~20.04.5, 0.6.55-0ubuntu13.3, 0.6.55-0ubuntu14.1.

### POC

#### Reference
- http://packetstormsecurity.com/files/172848/Ubuntu-accountsservice-Double-Free-Memory-Corruption.html

#### Github
No PoCs found on GitHub currently.

