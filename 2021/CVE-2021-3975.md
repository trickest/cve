### [CVE-2021-3975](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3975)
![](https://img.shields.io/static/v1?label=Product&message=libvirt&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=Fixed%20in%20libvirt%20v7.1.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-416%20-%20Use%20After%20Free&color=brightgreen)

### Description

A use-after-free flaw was found in libvirt. The qemuMonitorUnregister() function in qemuProcessHandleMonitorEOF is called using multiple threads without being adequately protected by a monitor lock. This flaw could be triggered by the virConnectGetAllDomainStats API when the guest is shutting down. An unprivileged client with a read-only connection could use this flaw to perform a denial of service attack by causing the libvirt daemon to crash.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cvemon

