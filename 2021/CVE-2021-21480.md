### [CVE-2021-21480](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21480)
![](https://img.shields.io/static/v1?label=Product&message=SAP%20Manufacturing%20Integration%20and%20Intelligence&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2015.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2015.2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2015.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2015.4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Code%20Execution&color=brightgreen)

### Description

SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code in the request and forward to server. When this dashboard is opened by users having at least SAP_XMII Developer role, malicious content in the dashboard gets executed, leading to remote code execution in the server, which allows privilege escalation. The malicious JSP code can contain certain OS commands, through which an attacker can read sensitive files in the server, modify files or even delete contents in the server thus compromising the confidentiality, integrity and availability of the server hosting the SAP MII application. Also, an attacker authenticated as a developer can use the application to upload and execute a file which will permit them to execute operating systems commands completely compromising the server hosting the application.

### POC

#### Reference
- http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html
- https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/Onapsis/vulnerability_advisories

