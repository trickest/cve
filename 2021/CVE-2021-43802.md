### [CVE-2021-43802](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43802)
![](https://img.shields.io/static/v1?label=Product&message=etherpad-lite&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.8.16%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-1287%3A%20Improper%20Validation%20of%20Specified%20Type%20of%20Input&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-790%3A%20Improper%20Filtering%20of%20Special%20Elements&color=brightgreen)

### Description

Etherpad is a real-time collaborative editor. In versions prior to 1.8.16, an attacker can craft an `*.etherpad` file that, when imported, might allow the attacker to gain admin privileges for the Etherpad instance. This, in turn, can be used to install a malicious Etherpad plugin that can execute arbitrary code (including system commands). To gain privileges, the attacker must be able to trigger deletion of `express-session` state or wait for old `express-session` state to be cleaned up. Core Etherpad does not delete any `express-session` state, so the only known attacks require either a plugin that can delete session state or a custom cleanup process (such as a cron job that deletes old `sessionstorage:*` records). The problem has been fixed in version 1.8.16. If users cannot upgrade to 1.8.16 or install patches manually, several workarounds are available. Users may configure their reverse proxies to reject requests to `/p/*/import`, which will block all imports, not just `*.etherpad` imports; limit all users to read-only access; and/or prevent the reuse of `express_sid` cookie values that refer to deleted express-session state. More detailed information and general mitigation strategies may be found in the GitHub Security Advisory.

### POC

#### Reference
- https://github.com/ether/etherpad-lite/releases/tag/1.8.16

#### Github
No PoCs found on GitHub currently.

