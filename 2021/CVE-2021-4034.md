### [CVE-2021-4034](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034)
![](https://img.shields.io/static/v1?label=Product&message=polkit&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%20all%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=(CWE-787%7CCWE-125)&color=brighgreen)

### Description

A local privilege escalation vulnerability was found on polkit's pkexec utility. The pkexec application is a setuid tool designed to allow unprivileged users to run commands as privileged users according predefined policies. The current version of pkexec doesn't handle the calling parameters count correctly and ends trying to execute environment variables as commands. An attacker can leverage this by crafting environment variables in such a way it'll induce pkexec to execute arbitrary code. When successfully executed the attack can cause a local privilege escalation given unprivileged users administrative rights on the target machine.

### POC

#### Reference
- http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html
- http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html
- https://www.oracle.com/security-alerts/cpuapr2022.html

#### Github
- https://github.com/0x01-sec/CVE-2021-4034-
- https://github.com/0x05a/my-cve-2021-4034-poc
- https://github.com/0x4ndy/CVE-2021-4034-PoC
- https://github.com/0xNix/CVE-2021-4034
- https://github.com/0xStrygwyr/OSCP-Guide
- https://github.com/0xZipp0/OSCP
- https://github.com/0xalwayslucky/log4j-polkit-poc
- https://github.com/0xsyr0/OSCP
- https://github.com/20142995/sectool
- https://github.com/A1vinSmith/CVE-2021-4034
- https://github.com/ARGOeu-Metrics/secmon-probes
- https://github.com/ARGOeu/secmon-probes
- https://github.com/ARPSyndicate/cvemon
- https://github.com/AabyssZG/AWD-Guide
- https://github.com/Abdibimantara/IncidentResponse--ElasticCase
- https://github.com/Al1ex/CVE-2021-4034
- https://github.com/Al1ex/LinuxEelvation
- https://github.com/Almorabea/pkexec-exploit
- https://github.com/An00bRektn/CVE-2021-4034
- https://github.com/AnastasiaLomova/PR1
- https://github.com/AnastasiaLomova/PR1.1
- https://github.com/Ankit-Ojha16/CVE-2021-4034
- https://github.com/Anonymous-Family/CVE-2021-4034
- https://github.com/ArrestX/--POC
- https://github.com/Astrogeorgeonethree/Starred2
- https://github.com/Audiobahn/CVE-2021-4034
- https://github.com/Aukaii/notes
- https://github.com/AvakyanAlexander/Number7
- https://github.com/AvakyanAlexander/Number7.1
- https://github.com/Awrrays/Pentest-Tips
- https://github.com/Ayrx/CVE-2021-4034
- https://github.com/BachoSeven/stellestelline
- https://github.com/BastG57/Random
- https://github.com/BryptoBlood/Cyber-Security-University
- https://github.com/C7H10N2/Hackergame2022_Writeup
- https://github.com/CITIZENDOT/CS547-CVEs
- https://github.com/CVEDB/awesome-cve-repo
- https://github.com/CVEDB/top
- https://github.com/CYB3RK1D/CVE-2021-4034-POC
- https://github.com/Desm0ndChan/OSCP-cheatsheet
- https://github.com/GhostTroops/TOP
- https://github.com/GibzB/THM-Captured-Rooms
- https://github.com/H3arn/hackergame-2022-writeup
- https://github.com/HadessCS/Awesome-Privilege-Escalation
- https://github.com/HattMobb/TryHackMe-Bugle-Machine-Writeup-Walkthrough
- https://github.com/IdanBanani/Linux-Kernel-VR-Exploitation
- https://github.com/JlSakuya/Linux-Privilege-Escalation-Exploits
- https://github.com/KayCHENvip/vulnerability-poc
- https://github.com/Kiosec/Linux-Exploitation
- https://github.com/LebJe/awesome-stars
- https://github.com/LeonardoE95/yt-it
- https://github.com/Ly0nt4r/OSCP
- https://github.com/Meowmycks/OSCPprep-Cute
- https://github.com/Meowmycks/OSCPprep-Sar
- https://github.com/Meowmycks/OSCPprep-hackme1
- https://github.com/Mr-xn/Penetration_Testing_POC
- https://github.com/Ostorlab/KEV
- https://github.com/SirElmard/ethical_hacking
- https://github.com/Snoopy-Sec/Localroot-ALL-CVE
- https://github.com/Somchandra17/Privilege-Escalation-For-Linux
- https://github.com/SugarP1g/LearningSecurity
- https://github.com/Taillan/TryHackMe
- https://github.com/Threekiii/Awesome-POC
- https://github.com/WhooAmii/POC_to_review
- https://github.com/YgorAlberto/Ethical-Hacker
- https://github.com/YgorAlberto/ygoralberto.github.io
- https://github.com/ZWDeJun/ZWDeJun
- https://github.com/Zeyad-Azima/Remedy4me
- https://github.com/amtzespinosa/lord-of-the-root-walkthrough
- https://github.com/anquanscan/sec-tools
- https://github.com/aus-mate/CVE-2021-4034-POC
- https://github.com/b1n4ryj4n/awesome-stars
- https://github.com/bollwarm/SecToolSet
- https://github.com/brootware/awesome-cyber-security-university
- https://github.com/cbass12321/OSCP-Cheat-Sheets
- https://github.com/cerodah/CVE-2021-4034
- https://github.com/chenaotian/CVE-2021-4034
- https://github.com/chorankates/Blunder
- https://github.com/chorankates/curling
- https://github.com/codiobert/pwnkit-scanner
- https://github.com/cr0ss2018/cr0ss2018
- https://github.com/cyberanand1337x/bug-bounty-2022
- https://github.com/d-rn/vulBox
- https://github.com/d3fenderz/linux_security
- https://github.com/d4n-sec/d4n-sec.github.io
- https://github.com/daltonmeridio/WriteUpHorizontall
- https://github.com/deathsticksguy/CEHv12Practical
- https://github.com/deoxykev/CVE-2021-4034-Rust
- https://github.com/fenipr/Shibboleth
- https://github.com/giterlizzi/secdb-feeds
- https://github.com/hackingyseguridad/CVE-2021-4034
- https://github.com/hegusung/netscan
- https://github.com/hktalent/bug-bounty
- https://github.com/hohn/codeql-sample-polkit
- https://github.com/hugefiver/mystars
- https://github.com/hxysaury/saury-vulnhub
- https://github.com/iandrade87br/OSCP
- https://github.com/jbmihoub/all-poc
- https://github.com/jenriquezv/OSCP-Cheat-Sheets
- https://github.com/jm33-m0/go-lpe
- https://github.com/jostmart/-CVE-2021-4034
- https://github.com/jwardsmith/Penetration-Testing
- https://github.com/k0mi-tg/CVE-POC
- https://github.com/kaosagnt/ansible-everyday
- https://github.com/kgwanjala/oscp-cheatsheet
- https://github.com/khulnasoft-lab/awesome-security
- https://github.com/kraloveckey/venom
- https://github.com/legovaer/my-awesome-stars
- https://github.com/lions2012/Penetration_Testing_POC
- https://github.com/makoto56/penetration-suite-toolkit
- https://github.com/manas3c/CVE-POC
- https://github.com/maxgfr/awesome-stars
- https://github.com/migueltc13/KoTH-Tools
- https://github.com/n1sh1th/CVE-POC
- https://github.com/nitishbadole/oscp-note-3
- https://github.com/open-source-agenda/new-open-source-projects
- https://github.com/oscpname/OSCP_cheat
- https://github.com/pancham1305/YearOfTheRabbit-thm
- https://github.com/personaone/OSCP
- https://github.com/phprogrammer86/CEH---NOTES
- https://github.com/promise2k/OSCP
- https://github.com/revanmalang/OSCP
- https://github.com/securi3ytalent/bugbounty-CVE-Report
- https://github.com/seeu-inspace/easyg
- https://github.com/soosmile/POC
- https://github.com/substing/ignite_ctf
- https://github.com/substing/internal_ctf
- https://github.com/substing/vulnerability_capstone_ctf
- https://github.com/substing/wonderland_ctf
- https://github.com/szaszm/pwnkit
- https://github.com/taielab/awesome-hacking-lists
- https://github.com/teresaweber685/book_list
- https://github.com/timb-machine/linux-malware
- https://github.com/trganda/starrlist
- https://github.com/uhub/awesome-c
- https://github.com/weeka10/-hktalent-TOP
- https://github.com/windware1203/InfoSec_study
- https://github.com/winterwolf32/CVE-S---Penetration_Testing_POC-
- https://github.com/xhref/OSCP
- https://github.com/xsudoxx/OSCP
- https://github.com/xuetusummer/Penetration_Testing_POC
- https://github.com/xymeng16/security

