### [CVE-2021-43304](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43304)
![](https://img.shields.io/static/v1?label=Product&message=clickhouse&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=unspecified%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-122&color=brightgreen)

### Description

Heap buffer overflow in Clickhouse's LZ4 compression codec when parsing a malicious query. There is no verification that the copy operations in the LZ4::decompressImpl loop and especially the arbitrary copy operation wildCopy<copy_amount>(op, ip, copy_end), don’t exceed the destination buffer’s limits.

### POC

#### Reference
- https://jfrog.com/blog/7-rce-and-dos-vulnerabilities-found-in-clickhouse-dbms

#### Github
- https://github.com/s3nt3/clickhouse-lz4-rce

