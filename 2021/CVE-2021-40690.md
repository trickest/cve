### [CVE-2021-40690](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40690)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20Santuario&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=XML%20Security%20for%20Java%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-200%20Exposure%20of%20Sensitive%20Information%20to%20an%20Unauthorized%20Actor&color=brightgreen)

### Description

All versions of Apache Santuario - XML Security for Java prior to 2.2.3 and 2.1.7 are vulnerable to an issue where the "secureValidation" property is not passed correctly when creating a KeyInfo from a KeyInfoReference element. This allows an attacker to abuse an XPath Transform to extract any local .xml files in a RetrievalMethod element.

### POC

#### Reference
- https://www.oracle.com/security-alerts/cpuapr2022.html
- https://www.oracle.com/security-alerts/cpujul2022.html

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/RosalindDeckow/java-saml
- https://github.com/SAML-Toolkits/java-saml
- https://github.com/VallieRunte/javascript-web
- https://github.com/onelogin/java-saml

