### [CVE-2021-22946](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22946)
![](https://img.shields.io/static/v1?label=Product&message=https%3A%2F%2Fgithub.com%2Fcurl%2Fcurl&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=curl%207.20.0%20to%20and%20including%207.78.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Missing%20Required%20Cryptographic%20Step%20(CWE-325)&color=brightgreen)

### Description

A user can tell curl >= 7.20.0 and <= 7.78.0 to require a successful upgrade to TLS when speaking to an IMAP, POP3 or FTP server (`--ssl-reqd` on the command line or`CURLOPT_USE_SSL` set to `CURLUSESSL_CONTROL` or `CURLUSESSL_ALL` withlibcurl). This requirement could be bypassed if the server would return a properly crafted but perfectly legitimate response.This flaw would then make curl silently continue its operations **withoutTLS** contrary to the instructions and expectations, exposing possibly sensitive data in clear text over the network.

### POC

#### Reference
- https://www.oracle.com/security-alerts/cpuapr2022.html
- https://www.oracle.com/security-alerts/cpujan2022.html
- https://www.oracle.com/security-alerts/cpujul2022.html
- https://www.oracle.com/security-alerts/cpuoct2021.html

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Mehedi-Babu/bug_bounty_begginer
- https://github.com/devopstales/trivy-operator
- https://github.com/fokypoky/places-list
- https://github.com/hetmehtaa/bug-bounty-guide
- https://github.com/hetmehtaa/bug-bounty-noob
- https://github.com/kenlavbah/log4jnotes

