### [CVE-2022-23522](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23522)
![](https://img.shields.io/static/v1?label=Product&message=mindsdb&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%2022.11.4.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-22%3A%20Improper%20Limitation%20of%20a%20Pathname%20to%20a%20Restricted%20Directory%20('Path%20Traversal')&color=brightgreen)

### Description

MindsDB is an open source machine learning platform. An unsafe extraction is being performed using `shutil.unpack_archive()` from a remotely retrieved tarball. Which may lead to the writing of the extracted files to an unintended location. This vulnerability is sometimes called a **TarSlip** or a **ZipSlip variant**. Unpacking files using the high-level function `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path remained within the intended destination directory may cause files to be overwritten outside the destination directory. An attacker could craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely using a personal bucket `s3`, thus, retrieve the tarball through **mindsdb** and overwrite the system files of the hosting server. This issue has been addressed in version 22.11.4.3. Users are advised to upgrade. Users unable to upgrade should avoid ingesting archives from untrusted sources.

### POC

#### Reference
- https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Sim4n6/Sim4n6

