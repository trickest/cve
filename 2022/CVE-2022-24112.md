### [CVE-2022-24112](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24112)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20APISIX&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=Apache%20APISIX%202.12%3C%202.12.1%20&color=brighgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-290%20Authentication%20Bypass%20by%20Spoofing&color=brighgreen)

### Description

An attacker can abuse the batch-requests plugin to send requests to bypass the IP restriction of Admin API. A default configuration of Apache APISIX (with default API key) is vulnerable to remote code execution. When the admin key was changed or the port of Admin API was changed to a port different from the data panel, the impact is lower. But there is still a risk to bypass the IP restriction of Apache APISIX's data panel. There is a check in the batch-requests plugin which overrides the client IP with its real remote IP. But due to a bug in the code, this check can be bypassed.

### POC

#### Reference
- http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
- http://packetstormsecurity.com/files/166328/Apache-APISIX-2.12.1-Remote-Code-Execution.html

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/Awrrays/FrameVul
- https://github.com/Axx8/CVE-2022-24112
- https://github.com/Greetdawn/Apache-APISIX-dashboard-RCE
- https://github.com/M4xSec/Apache-APISIX-CVE-2022-24112
- https://github.com/Mah1ndra/CVE-2022-24112
- https://github.com/Mah1ndra/CVE-2022-244112
- https://github.com/Mr-xn/CVE-2022-24112
- https://github.com/Udyz/CVE-2022-24112
- https://github.com/binganao/vulns-2022
- https://github.com/hktalent/TOP
- https://github.com/kavishkagihan/CVE-2022-24112-POC
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/shakeman8/CVE-2022-24112
- https://github.com/soosmile/POC
- https://github.com/twseptian/cve-2022-24112

