### [CVE-2022-42889](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42889)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20Commons%20Text&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=1.5%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=unspecified%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Unexpected%20variable%20interpolation&color=brightgreen)

### Description

Apache Commons Text performs variable interpolation, allowing properties to be dynamically evaluated and expanded. The standard format for interpolation is "${prefix:name}", where "prefix" is used to locate an instance of org.apache.commons.text.lookup.StringLookup that performs the interpolation. Starting with version 1.5 and continuing through 1.9, the set of default Lookup instances included interpolators that could result in arbitrary code execution or contact with remote servers. These lookups are: - "script" - execute expressions using the JVM script execution engine (javax.script) - "dns" - resolve dns records - "url" - load values from urls, including from remote servers Applications using the interpolation defaults in the affected versions may be vulnerable to remote code execution or unintentional contact with remote servers if untrusted configuration values are used. Users are recommended to upgrade to Apache Commons Text 1.10.0, which disables the problematic interpolators by default.

### POC

#### Reference
- http://packetstormsecurity.com/files/171003/OX-App-Suite-Cross-Site-Scripting-Server-Side-Request-Forgery.html
- http://packetstormsecurity.com/files/176650/Apache-Commons-Text-1.9-Remote-Code-Execution.html

#### Github
- https://github.com/0x783kb/Security-operation-book
- https://github.com/0xAgun/subscribe-for-more
- https://github.com/0xmaximus/Apache-Commons-Text-CVE-2022-42889
- https://github.com/0xst4n/CVE-2022-42889
- https://github.com/20142995/nuclei-templates
- https://github.com/2lambda123/og4j-scan
- https://github.com/34006133/CVE-2022-42889
- https://github.com/808ale/CVE-2022-42889-Text4Shell-POC
- https://github.com/A0WaQ4/BurpText4ShellScan
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Afrouper/MavenDependencyCVE-Scanner
- https://github.com/Bl0omZ/JAVAExploitStudy
- https://github.com/BuildScale/log4j.scan
- https://github.com/Cad3n/SecureCodingDemo
- https://github.com/ClickCyber/cve-2022-42889
- https://github.com/Dima2021/cve-2022-42889-text4shell
- https://github.com/DimaMend/cve-2022-42889-text4shell
- https://github.com/Drun1baby/JavaSecurityLearning
- https://github.com/EssenceCyber/Exploit-List
- https://github.com/Gomez0015/text4shell
- https://github.com/Gotcha-1G/CVE-2022-42889
- https://github.com/Gotcha1G/CVE-2022-42889
- https://github.com/HKirito/CVE-2022-33980
- https://github.com/Hack4rLIFE/CVE-2022-42889
- https://github.com/J1ezds/Vulnerability-Wiki-page
- https://github.com/Ji82466dx21ohnDavi69no0dinans/awesome-security-vul-llm
- https://github.com/LeoHLee/GeekGame-2nd-Leo_h
- https://github.com/Martian1337/Martian1337
- https://github.com/Mav0y56cgi4rie8clu4e5vrBarnett/awesome-security-vul-llm
- https://github.com/MendDemo-josh/cve-2022-42889-text4shell
- https://github.com/Mr-Tree-S/POC_EXP
- https://github.com/Mr-xn/BurpSuite-collections
- https://github.com/PandyBoyo/scanner
- https://github.com/PedroJQL/java-vulnerable-app
- https://github.com/QAInsights/cve-2022-42889-jmeter
- https://github.com/Qualys/text4scanwin
- https://github.com/RIP-Network/cve-2022-42889-scanner
- https://github.com/RSA-Demo/cve-2022-42889-text4shell
- https://github.com/Ratlesv/Log4j-SCAN
- https://github.com/RaxoCoding/text4shell
- https://github.com/ReachabilityOrg/cve-2022-42889-text4shell-docker
- https://github.com/RjRaju143/THM-CTF-ROOM
- https://github.com/RjRaju143/java-CTF
- https://github.com/SeanWrightSec/CVE-2022-42889-PoC
- https://github.com/SeanWrightSec/Docker-to-the-Security
- https://github.com/Sic4rio/CVE-2022-42889
- https://github.com/Sikako/text4shell-website
- https://github.com/Syndicate27/text4shell-exploit
- https://github.com/TehanG07/log4j-scan
- https://github.com/TheMuntu/TheMuntu
- https://github.com/Threekiii/Awesome-POC
- https://github.com/Vamckis/Container-Security
- https://github.com/Vulnmachines/text4shell-CVE-2022-42889
- https://github.com/WFS-Mend/vtrade-common
- https://github.com/Whoopsunix/PPPVULNS
- https://github.com/XRSec/AWVS-Update
- https://github.com/XiaomingX/awesome-poc-for-red-team
- https://github.com/Y4tacker/JavaSec
- https://github.com/aaronm-sysdig/text4shell-docker
- https://github.com/adarshpv9746/Text4shell--Automated-exploit---CVE-2022-42889
- https://github.com/akshayithape-devops/CVE-2022-42889-POC
- https://github.com/aneasystone/github-trending
- https://github.com/bit3/jsass
- https://github.com/bollwarm/SecToolSet
- https://github.com/chainguard-dev/text4shell-policy
- https://github.com/chaudharyarjun/text4shell-exploit
- https://github.com/cryxnet/CVE-2022-42889-RCE
- https://github.com/cryxnet/cryxnet
- https://github.com/cxzero/CVE-2022-42889-text4shell
- https://github.com/d4n-sec/d4n-sec.github.io
- https://github.com/davidwowa/tech.cybersword.poc.log4j.text4shell
- https://github.com/devantler-tech/platform
- https://github.com/devenes/text4shell-cve-2022-42889
- https://github.com/dgor2023/cve-2022-42889-text4shell-docker
- https://github.com/dzulqarnain28/burpsuite
- https://github.com/eunomie/cve-2022-42889-check
- https://github.com/f0ng/text4shellburpscanner
- https://github.com/fardeen-ahmed/Bug-bounty-Writeups
- https://github.com/fullhunt/log4j-scan
- https://github.com/galoget/CVE-2022-42889-Text4Shell-Docker
- https://github.com/giterlizzi/secdb-feeds
- https://github.com/gokul-ramesh/text4shell-exploit
- https://github.com/gustanini/CVE-2022-42889-Text4Shell-POC
- https://github.com/hakimsa/toolscans-repo
- https://github.com/haraamzadaa/text4shell-scan-common-text-calls
- https://github.com/hotblac/text4shell
- https://github.com/humbss/CVE-2022-42889
- https://github.com/husnain-ce/Log4j-Scan
- https://github.com/iamsanjay/CVE-2022-42899
- https://github.com/iamthefrogy/BountyHound
- https://github.com/ifconfig-me/Log4Shell-Payloads
- https://github.com/inj3ction/log4j-scan
- https://github.com/insecrez/Bug-bounty-Writeups
- https://github.com/jar-analyzer/jar-analyzer
- https://github.com/jayaram-yalla/CVE-2022-42889-POC_TEXT4SHELL
- https://github.com/jfrog/text4shell-tools
- https://github.com/joshbnewton31080/cve-2022-42889-text4shell
- https://github.com/junius-sec/kr-vulhub
- https://github.com/k0mi-tg/CVE-POC
- https://github.com/karimhabush/cyberowl
- https://github.com/karthikuj/cve-2022-42889-text4shell-docker
- https://github.com/kcoble/lab-audition
- https://github.com/kiralab/text4shell-scan
- https://github.com/kljunowsky/CVE-2022-42889-text4shell
- https://github.com/korteke/CVE-2022-42889-POC
- https://github.com/ljklionel/oscp-notes
- https://github.com/log4jcodes/log4j.scan
- https://github.com/manas3c/CVE-POC
- https://github.com/necroteddy/CVE-2022-42889
- https://github.com/neerazz/CVE-2022-42889
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/numencyber/Vulnerability_PoC
- https://github.com/phixion/phixion
- https://github.com/plzheheplztrying/cve_monitor
- https://github.com/pwnb0y/Text4shell-exploit
- https://github.com/py-legend/text4shell-tools
- https://github.com/rggu2zr/rggu2zr
- https://github.com/rhitikwadhvana/CVE-2022-42889-Text4Shell-Exploit-POC
- https://github.com/robkoo/EndpointAnalytics-RemediationScript-Apache-Commons-text
- https://github.com/rockmelodies/CVE-2022-42889
- https://github.com/ronin-dojo/oscp-notes
- https://github.com/s3l33/CVE-2022-42889
- https://github.com/securekomodo/text4shell-poc
- https://github.com/securekomodo/text4shell-scan
- https://github.com/shoucheng3/asf__commons-text_CVE-2022-42889_1-9
- https://github.com/silentsignal/burp-text4shell
- https://github.com/smileostrich/Text4Shell-Scanner
- https://github.com/sophxe/suricata-rules
- https://github.com/standb/CVE-2022-42889
- https://github.com/stavrosgns/Text4ShellPayloads
- https://github.com/sunnyvale-it/CVE-2022-42889-PoC
- https://github.com/tanjiti/sec_profile
- https://github.com/teplyuska/spring-boot-actuator-info-demo
- https://github.com/teresaweber685/book_list
- https://github.com/tulhan/commons-text-goat
- https://github.com/uk0/cve-2022-42889-intercept
- https://github.com/vickyaryan7/Text4shell-exploit
- https://github.com/wangweixuan/pku-geekgame-2nd
- https://github.com/west-wind/CVE-2022-42889
- https://github.com/west-wind/Threat-Hunting-With-Splunk
- https://github.com/wetpossum1/java-test-app-vis
- https://github.com/whoforget/CVE-POC
- https://github.com/xu-xiang/awesome-security-vul-llm
- https://github.com/youwizard/CVE-POC

