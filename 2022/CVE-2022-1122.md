### [CVE-2022-1122](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1122)
![](https://img.shields.io/static/v1?label=Product&message=openjpeg2&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=openjpeg2%20version%202.4.0%20and%20prior%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-665-%3ECWE-824&color=brightgreen)

### Description

A flaw was found in the opj2_decompress program in openjpeg2 2.4.0 in the way it handles an input directory with a large number of files. When it fails to allocate a buffer to store the filenames of the input directory, it calls free() on an uninitialized pointer, leading to a segmentation fault and a denial of service.

### POC

#### Reference
- https://github.com/uclouvain/openjpeg/issues/1368

#### Github
- https://github.com/mzs555557/SosReverterbench
- https://github.com/w4zu/Debian_security

