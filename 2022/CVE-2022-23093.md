### [CVE-2022-23093](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23093)
![](https://img.shields.io/static/v1?label=Product&message=FreeBSD&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=12.3-RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=12.4-RC2%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=13.1-RELEASE%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

ping reads raw IP packets from the network to process responses in the pr_pack() function.  As part of processing a response ping has to reconstruct the IP header, the ICMP header and if present a "quoted packet," which represents the packet that generated an ICMP error.  The quoted packet again has an IP header and an ICMP header.The pr_pack() copies received IP and ICMP headers into stack buffers for further processing.  In so doing, it fails to take into account the possible presence of IP option headers following the IP header in either the response or the quoted packet.  When IP options are present, pr_pack() overflows the destination buffer by up to 40 bytes.The memory safety bugs described above can be triggered by a remote host, causing the ping program to crash.The ping process runs in a capability mode sandbox on all affected versions of FreeBSD and is thus very constrained in how it can interact with the rest of the system at the point where the bug can occur.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/H4lo/awesome-IoT-security-article
- https://github.com/Inplex-sys/CVE-2022-23093
- https://github.com/Symbolexe/DrayTek-Exploit
- https://github.com/SystemVll/CVE-2022-23093
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/k0imet/pyfetch
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/plzheheplztrying/cve_monitor

