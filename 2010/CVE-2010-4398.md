### [CVE-2010-4398](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4398)
![](https://img.shields.io/static/v1?label=Product&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

Stack-based buffer overflow in the RtlQueryRegistryValues function in win32k.sys in Microsoft Windows XP SP2 and SP3, Windows Server 2003 SP2, Windows Vista SP1 and SP2, Windows Server 2008 Gold, SP2, and R2, and Windows 7 allows local users to gain privileges, and bypass the User Account Control (UAC) feature, via a crafted REG_BINARY value for a SystemDefaultEUDCFont registry key, aka "Driver Improper Interaction with Windows Kernel Vulnerability."

### POC

#### Reference
- http://isc.sans.edu/diary.html?storyid=9988
- http://nakedsecurity.sophos.com/2010/11/25/new-windows-zero-day-flaw-bypasses-uac/
- http://www.exploit-db.com/exploits/15609/

#### Github
- https://github.com/Al1ex/WindowsElevation
- https://github.com/Ascotbe/Kernelhub
- https://github.com/fei9747/WindowsElevation

