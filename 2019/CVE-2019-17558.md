### [CVE-2019-17558](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17558)
![](https://img.shields.io/static/v1?label=Product&message=Apache%20Solr&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=Information%20Disclosure&color=brighgreen)

### Description

Apache Solr 5.0.0 to Apache Solr 8.3.1 are vulnerable to a Remote Code Execution through the VelocityResponseWriter. A Velocity template can be provided through Velocity templates in a configset `velocity/` directory or as a parameter. A user defined configset could contain renderable, potentially malicious, templates. Parameter provided templates are disabled by default, but can be enabled by setting `params.resource.loader.enabled` by defining a response writer with that setting set to `true`. Defining a response writer requires configuration API access. Solr 8.4 removed the params resource loader entirely, and only enables the configset-provided template rendering when the configset is `trusted` (has been uploaded by an authenticated user).

### POC

#### Reference
- http://packetstormsecurity.com/files/157078/Apache-Solr-8.3.0-Velocity-Template-Remote-Code-Execution.html
- https://www.oracle.com/security-alerts/cpuoct2020.html

#### Github
- https://github.com/0xT11/CVE-POC
- https://github.com/ARPSyndicate/cvemon
- https://github.com/ARPSyndicate/kenzer-templates
- https://github.com/CLincat/vulcat
- https://github.com/Elsfa7-110/kenzer-templates
- https://github.com/Imanfeng/Apache-Solr-RCE
- https://github.com/JERRY123S/all-poc
- https://github.com/Ma1Dong/Solr_CVE-2019-17558
- https://github.com/Mr-xn/Penetration_Testing_POC
- https://github.com/Nishacid/Easy_RCE_Scanner
- https://github.com/SDNDTeam/CVE-2019-17558_Solr_Vul_Tool
- https://github.com/SexyBeast233/SecBooks
- https://github.com/Threekiii/Awesome-POC
- https://github.com/Threekiii/Vulhub-Reproduce
- https://github.com/bigblackhat/oFx
- https://github.com/cyberanand1337x/bug-bounty-2022
- https://github.com/developer3000S/PoC-in-GitHub
- https://github.com/flyarong/pwnserver
- https://github.com/hanc00l/some_pocsuite
- https://github.com/hectorgie/PoC-in-GitHub
- https://github.com/hktalent/TOP
- https://github.com/huike007/penetration_poc
- https://github.com/huimzjty/vulwiki
- https://github.com/koala2099/GitHub-Chinese-Top-Charts
- https://github.com/merlinepedra/nuclei-templates
- https://github.com/merlinepedra25/nuclei-templates
- https://github.com/mustblade/solr_hacktool
- https://github.com/neilzhang1/Chinese-Charts
- https://github.com/openx-org/BLEN
- https://github.com/pinkieli/GitHub-Chinese-Top-Charts
- https://github.com/qingyuanfeiniao/Chinese-Top-Charts
- https://github.com/rockmelodies/rocComExpRce
- https://github.com/sobinge/nuclei-templates
- https://github.com/veracode-research/solr-injection
- https://github.com/weeka10/-hktalent-TOP
- https://github.com/winterwolf32/CVE-S---Penetration_Testing_POC-
- https://github.com/woods-sega/woodswiki
- https://github.com/xkyrage/Exploit_CVE-2019-17558-RCE
- https://github.com/zhzyker/exphub
- https://github.com/zoroqi/my-awesome

