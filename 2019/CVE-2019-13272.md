### [CVE-2019-13272](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13272)
![](https://img.shields.io/static/v1?label=Product&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=brighgreen)

### Description

In the Linux kernel before 5.1.17, ptrace_link in kernel/ptrace.c mishandles the recording of the credentials of a process that wants to create a ptrace relationship, which allows local users to obtain root access by leveraging certain scenarios with a parent-child process relationship, where a parent drops privileges and calls execve (potentially allowing control by an attacker). One contributing factor is an object lifetime issue (which can also cause a panic). Another contributing factor is incorrect marking of a ptrace relationship as privileged, which is exploitable through (for example) Polkit's pkexec helper with PTRACE_TRACEME. NOTE: SELinux deny_ptrace might be a usable workaround in some environments.

### POC

#### Reference
- http://packetstormsecurity.com/files/153663/Linux-PTRACE_TRACEME-Broken-Permission-Object-Lifetime-Handling.html
- http://packetstormsecurity.com/files/153702/Slackware-Security-Advisory-Slackware-14.2-kernel-Updates.html
- http://packetstormsecurity.com/files/154245/Kernel-Live-Patch-Security-Notice-LSN-0054-1.html
- http://packetstormsecurity.com/files/154957/Linux-Polkit-pkexec-Helper-PTRACE_TRACEME-Local-Root.html
- http://packetstormsecurity.com/files/156929/Linux-PTRACE_TRACEME-Local-Root.html
- http://packetstormsecurity.com/files/165051/Linux-Kernel-5.1.x-PTRACE_TRACEME-pkexec-Local-Privilege-Escalation.html
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.1.17

#### Github
- https://github.com/0xMrNiko/Awesome-Red-Teaming
- https://github.com/0xT11/CVE-POC
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Al1ex/LinuxEelvation
- https://github.com/Amar224/Pentest-Tools
- https://github.com/AnonVulc/Pentest-Tools
- https://github.com/CnHack3r/Penetration_PoC
- https://github.com/Cyc1eC/CVE-2019-13272
- https://github.com/De4dCr0w/Linux-kernel-EoP-exp
- https://github.com/Getshell/LinuxTQ
- https://github.com/H0j3n/EzpzCheatSheet
- https://github.com/H1CH444MREB0RN/PenTest-free-tools
- https://github.com/HaleyWei/POC-available
- https://github.com/Huandtx/CVE-2019-13272
- https://github.com/JERRY123S/all-poc
- https://github.com/Mr-xn/Penetration_Testing_POC
- https://github.com/ONQLin/OS-CourseDesign
- https://github.com/Offensive-Penetration-Security/OPSEC-Hall-of-fame
- https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-
- https://github.com/S3cur3Th1sSh1t/Pentest-Tools
- https://github.com/SexyBeast233/SecBooks
- https://github.com/Snoopy-Sec/Localroot-ALL-CVE
- https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability
- https://github.com/Tharana/vulnerability-exploitation
- https://github.com/YIXINSHUWU/Penetration_Testing_POC
- https://github.com/YellowVeN0m/Pentesters-toolbox
- https://github.com/alphaSeclab/sec-daily-2019
- https://github.com/anoaghost/Localroot_Compile
- https://github.com/bcoles/kernel-exploits
- https://github.com/bigbigliang-malwarebenchmark/cve-2019-13272
- https://github.com/cedelasen/htb-laboratory
- https://github.com/cyberanand1337x/bug-bounty-2022
- https://github.com/developer3000S/PoC-in-GitHub
- https://github.com/fei9747/LinuxEelvation
- https://github.com/fengjixuchui/RedTeamer
- https://github.com/go-bi/go-bi-soft
- https://github.com/hack-parthsharma/Pentest-Tools
- https://github.com/hasee2018/Penetration_Testing_POC
- https://github.com/hectorgie/PoC-in-GitHub
- https://github.com/hktalent/TOP
- https://github.com/huike007/penetration_poc
- https://github.com/huike007/poc
- https://github.com/icecliffs/Linux-For-Root
- https://github.com/jana30116/CVE-2019-13272-Local-Privilege-Escalation
- https://github.com/jared1981/More-Pentest-Tools
- https://github.com/jas502n/CVE-2019-13272
- https://github.com/jiayy/android_vuln_poc-exp
- https://github.com/karlhat/Ksplice-demo
- https://github.com/merlinepedra/Pentest-Tools
- https://github.com/merlinepedra25/Pentest-Tools
- https://github.com/merlinepedra25/Pentest-Tools-1
- https://github.com/n3t1nv4d3/kernel-exploits
- https://github.com/nitishbadole/Pentest_Tools
- https://github.com/nu11secur1ty/CVE-mitre
- https://github.com/oneoy/CVE-2019-13272
- https://github.com/password520/Penetration_PoC
- https://github.com/password520/RedTeamer
- https://github.com/pathakabhi24/Pentest-Tools
- https://github.com/pjgmonteiro/Pentest-tools
- https://github.com/polosec/CVE-2019-13272
- https://github.com/pwnCmndr/LinuxPrivEsc
- https://github.com/qazbnm456/awesome-cve-poc
- https://github.com/rakjong/LinuxElevation
- https://github.com/retr0-13/Pentest-Tools
- https://github.com/severnake/Pentest-Tools
- https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272
- https://github.com/teddy47/CVE-2019-13272---Documentation
- https://github.com/theyoge/AD-Pentesting-Tools
- https://github.com/weeka10/-hktalent-TOP
- https://github.com/winterwolf32/CVE-S---Penetration_Testing_POC-
- https://github.com/xbl3/awesome-cve-poc_qazbnm456
- https://github.com/yedada-wei/-
- https://github.com/yedada-wei/gongkaishouji

