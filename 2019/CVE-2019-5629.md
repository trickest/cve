### [CVE-2019-5629](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5629)
![](https://img.shields.io/static/v1?label=Product&message=Insight%20Agent&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=2.6.3%20and%20prior%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-427%3A%20Uncontrolled%20Search%20Path%20Element&color=brightgreen)

### Description

Rapid7 Insight Agent, version 2.6.3 and prior, suffers from a local privilege escalation due to an uncontrolled DLL search path. Specifically, when Insight Agent 2.6.3 and prior starts, the Python interpreter attempts to load python3.dll at "C:\DLLs\python3.dll," which normally is writable by locally authenticated users. Because of this, a malicious local user could use Insight Agent's startup conditions to elevate to SYSTEM privileges. This issue was fixed in Rapid7 Insight Agent 2.6.4.

### POC

#### Reference
- http://packetstormsecurity.com/files/153159/Rapid7-Windows-InsightIDR-Agent-2.6.3.14-Local-Privilege-Escalation.html
- http://seclists.org/fulldisclosure/2019/Jun/13
- https://bogner.sh/2019/06/local-privilege-escalation-in-rapid7s-windows-insight-idr-agent/
- https://seclists.org/bugtraq/2019/Jun/0

#### Github
No PoCs found on GitHub currently.

