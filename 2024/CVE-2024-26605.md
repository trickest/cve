### [CVE-2024-26605](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26605)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=1f2f662c8bec75d1311e063efaa9107435cf16c8%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=8cc22ba3f77c59df5f1ac47d62df51efb28cd868%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=b9c370b61d735a0e5390c42771e7eb21413f7868%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=f93e71aea6c60ebff8adbd8941e678302d377869%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:PCI/ASPM: Fix deadlock when enabling ASPMA last minute revert in 6.7-final introduced a potential deadlock whenenabling ASPM during probe of Qualcomm PCIe controllers as reported bylockdep:  ============================================  WARNING: possible recursive locking detected  6.7.0 #40 Not tainted  --------------------------------------------  kworker/u16:5/90 is trying to acquire lock:  ffffacfa78ced000 (pci_bus_sem){++++}-{3:3}, at: pcie_aspm_pm_state_change+0x58/0xdc              but task is already holding lock:  ffffacfa78ced000 (pci_bus_sem){++++}-{3:3}, at: pci_walk_bus+0x34/0xbc              other info that might help us debug this:   Possible unsafe locking scenario:         CPU0         ----    lock(pci_bus_sem);    lock(pci_bus_sem);               *** DEADLOCK ***  Call trace:   print_deadlock_bug+0x25c/0x348   __lock_acquire+0x10a4/0x2064   lock_acquire+0x1e8/0x318   down_read+0x60/0x184   pcie_aspm_pm_state_change+0x58/0xdc   pci_set_full_power_state+0xa8/0x114   pci_set_power_state+0xc4/0x120   qcom_pcie_enable_aspm+0x1c/0x3c [pcie_qcom]   pci_walk_bus+0x64/0xbc   qcom_pcie_host_post_init_2_7_0+0x28/0x34 [pcie_qcom]The deadlock can easily be reproduced on machines like the Lenovo ThinkPadX13s by adding a delay to increase the race window during asynchronousprobe where another thread can take a write lock.Add a new pci_set_power_state_locked() and associated helper functions thatcan be called with the PCI bus semaphore held to avoid taking the read locktwice.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds

