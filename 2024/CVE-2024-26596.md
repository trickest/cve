### [CVE-2024-26596](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26596)
![](https://img.shields.io/static/v1?label=Product&message=Linux&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=4c3f80d22b2eca911143ce656fa45c4699ff5bf4%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=6.1%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=n%2Fa&color=blue)

### Description

In the Linux kernel, the following vulnerability has been resolved:net: dsa: fix netdev_priv() dereference before check on non-DSA netdevice eventsAfter the blamed commit, we started doing this dereference for everyNETDEV_CHANGEUPPER and NETDEV_PRECHANGEUPPER event in the system.static inline struct dsa_port *dsa_user_to_port(const struct net_device *dev){	struct dsa_user_priv *p = netdev_priv(dev);	return p->dp;}Which is obviously bogus, because not all net_devices have a netdev_priv()of type struct dsa_user_priv. But struct dsa_user_priv is fairly small,and p->dp means dereferencing 8 bytes starting with offset 16. Mostdrivers allocate that much private memory anyway, making our access notfault, and we discard the bogus data quickly afterwards, so this wasn'tcaught.But the dummy interface is somewhat special in that it callsalloc_netdev() with a priv size of 0. So every netdev_priv() dereferenceis invalid, and we get this when we emit a NETDEV_PRECHANGEUPPER eventwith a VLAN as its new upper:$ ip link add dummy1 type dummy$ ip link add link dummy1 name dummy1.100 type vlan id 100[   43.309174] ==================================================================[   43.316456] BUG: KASAN: slab-out-of-bounds in dsa_user_prechangeupper+0x30/0xe8[   43.323835] Read of size 8 at addr ffff3f86481d2990 by task ip/374[   43.330058][   43.342436] Call trace:[   43.366542]  dsa_user_prechangeupper+0x30/0xe8[   43.371024]  dsa_user_netdevice_event+0xb38/0xee8[   43.375768]  notifier_call_chain+0xa4/0x210[   43.379985]  raw_notifier_call_chain+0x24/0x38[   43.384464]  __netdev_upper_dev_link+0x3ec/0x5d8[   43.389120]  netdev_upper_dev_link+0x70/0xa8[   43.393424]  register_vlan_dev+0x1bc/0x310[   43.397554]  vlan_newlink+0x210/0x248[   43.401247]  rtnl_newlink+0x9fc/0xe30[   43.404942]  rtnetlink_rcv_msg+0x378/0x580Avoid the kernel oops by dereferencing after the type check, as customary.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/w4zu/Debian_security

