### [CVE-2024-31459](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31459)
![](https://img.shields.io/static/v1?label=Product&message=cacti&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.2.27%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=-%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-98%3A%20Improper%20Control%20of%20Filename%20for%20Include%2FRequire%20Statement%20in%20PHP%20Program%20('PHP%20Remote%20File%20Inclusion')&color=brightgreen)

### Description

Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, there is a file inclusion issue in the `lib/plugin.php` file. Combined with SQL injection vulnerabilities, remote code execution can be implemented. There is a file inclusion issue with the `api_plugin_hook()` function in the `lib/plugin.php` file, which reads the plugin_hooks and plugin_config tables in database. The read data is directly used to concatenate the file path which is used for file inclusion. Version 1.2.27 contains a patch for the issue.

### POC

#### Reference
- https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv
- https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r

#### Github
- https://github.com/J1ezds/Vulnerability-Wiki-page
- https://github.com/Threekiii/Awesome-POC

