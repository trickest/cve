### [CVE-2024-25623](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25623)
![](https://img.shields.io/static/v1?label=Product&message=mastodon&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%203.5.19%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%204.0.0%2C%20%3C%204.0.15%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%204.1.0%2C%20%3C%204.1.15%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=%3E%3D%204.2.0%2C%20%3C%204.2.7%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-434%3A%20Unrestricted%20Upload%20of%20File%20with%20Dangerous%20Type&color=brightgreen)

### Description

Mastodon is a free, open-source social network server based on ActivityPub. Prior to versions 4.2.7, 4.1.15, 4.0.15, and 3.5.19, when fetching remote statuses, Mastodon doesn't check that the response from the remote server has a `Content-Type` header value of the Activity Streams media type, which allows a threat actor to upload a crafted Activity Streams document to a remote server and make a Mastodon server fetch it, if the remote server accepts arbitrary user uploads. The vulnerability allows a threat actor to impersonate an account on a remote server that satisfies all of the following properties: allows the attacker to register an account; accepts arbitrary user-uploaded documents and places them on the same domain as the ActivityPub actors; and serves user-uploaded document in response to requests with an `Accept` header value of the Activity Streams media type. Versions 4.2.7, 4.1.15, 4.0.15, and 3.5.19 contain a fix for this issue.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/fkie-cad/nvd-json-data-feeds
- https://github.com/tesaguri/activitypub-type-confusion-poc

