### [CVE-2024-56363](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56363)
![](https://img.shields.io/static/v1?label=Product&message=APTRS&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3D%201.0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-97%3A%20Improper%20Neutralization%20of%20Server-Side%20Includes%20(SSI)%20Within%20a%20Web%20Page&color=brightgreen)

### Description

APTRS (Automated Penetration Testing Reporting System) is a Python and Django-based automated reporting tool designed for penetration testers and security organizations. In 1.0, there is a vulnerability in the web application's handling of user-supplied input that is incorporated into a Jinja2 template. Specifically, when user input is improperly sanitized or validated, an attacker can inject Jinja2 syntax into the template, causing the server to execute arbitrary code. For example, an attacker might be able to inject expressions like {{ config }}, {{ self.class.mro[1].subclasses() }}, or more dangerous payloads that trigger execution of arbitrary Python code. The vulnerability can be reproduced by submitting crafted input to all the template fields handled by ckeditor, that are passed directly to a Jinja2 template. If the input is rendered without sufficient sanitization, it results in the execution of malicious Jinja2 code on the server.

### POC

#### Reference
- https://github.com/APTRS/APTRS/commit/9f6b6e4a56a9119eb12126a4909441e83b6d7c11
- https://github.com/APTRS/APTRS/security/advisories/GHSA-h4w2-hvcg-938j

#### Github
- https://github.com/APTRS/APTRS-Changelog

