### [CVE-2024-30270](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-30270)
![](https://img.shields.io/static/v1?label=Product&message=mailcow-dockerized&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%202024-04%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-22%3A%20Improper%20Limitation%20of%20a%20Pathname%20to%20a%20Restricted%20Directory%20('Path%20Traversal')&color=brightgreen)

### Description

mailcow: dockerized is an open source groupware/email suite based on docker. A security vulnerability has been identified in mailcow affecting versions prior to 2024-04. This vulnerability is a combination of path traversal and arbitrary code execution, specifically targeting the `rspamd_maps()` function. It allows authenticated admin users to overwrite any file writable by the www-data user by exploiting improper path validation. The exploit chain can lead to the execution of arbitrary commands on the server. Version 2024-04 contains a patch for the issue.

### POC

#### Reference
- https://www.vicarius.io/vsociety/posts/mailcow-with-xss-and-path-traversal-cve-2024-31204-and-cve-2024-30270

#### Github
- https://github.com/ARPSyndicate/cve-scores
- https://github.com/Alchemist3dot14/CVE-2024-30270-PoC
- https://github.com/ismailmazumder/SL7CVELabsBuilder
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/securelayer7/Research

