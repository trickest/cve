### [CVE-2024-28117](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-28117)
![](https://img.shields.io/static/v1?label=Product&message=grav&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C%201.7.45%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-94%3A%20Improper%20Control%20of%20Generation%20of%20Code%20('Code%20Injection')&color=brightgreen)

### Description

Grav is an open-source, flat-file content management system. Prior to version 1.7.45, Grav validates accessible functions through the Utils::isDangerousFunction function, but does not impose restrictions on twig functions like twig_array_map, allowing attackers to bypass the validation and execute arbitrary commands. Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages. As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance. Upgrading to patched version 1.7.45 can mitigate this issue.

### POC

#### Reference
- https://github.com/getgrav/grav/security/advisories/GHSA-qfv4-q44r-g7rv

#### Github
- https://github.com/NaInSec/CVE-LIST

