### [CVE-2024-50592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50592)
![](https://img.shields.io/static/v1?label=Product&message=Elefant%20Software%20Updater&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=%3C1.4.2.1811%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Version&message=0%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=CWE-367%20Time-of-check%20Time-of-use%20(TOCTOU)%20Race%20Condition&color=brightgreen)

### Description

An attacker with local access the to medical office computer can escalate his Windows user privileges to "NT AUTHORITY\SYSTEM" by exploiting a race condition in the Elefant Update Service during the repair or update process. When using the repair function, the service queries the server for a list of files and their hashes. In addition, instructions to execute binaries to finalize the repair process are included. The executables are executed as "NT AUTHORITY\SYSTEM" after they are copied over to the user writable installation folder (C:\Elefant1). This means that a user can overwrite either "PostESUUpdate.exe" or "Update_OpenJava.exe" in the time frame after the copy and before the execution of the final repair step. The overwritten executable is then executed as "NT AUTHORITY\SYSTEM".

### POC

#### Reference
- https://r.sec-consult.com/hasomed

#### Github
No PoCs found on GitHub currently.

