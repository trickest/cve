### [CVE-2018-5741](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5741)
![](https://img.shields.io/static/v1?label=Product&message=BIND%209&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=BIND%209%20Versions%20prior%20to%20BIND%209.11.5%20and%20BIND%209.12.3%20&color=brightgreen)
![](https://img.shields.io/static/v1?label=Vulnerability&message=The%20krb5-subdomain%20and%20ms-subdomain%20update%20policy%20rule%20types%20permit%20updates%20from%20any%20client%20authenticated%20with%20a%20valid%20Kerberos%20or%20Windows%20machine%20principal%20from%20the%20REALM%20specified%20in%20the%20identity%20field%2C%20to%20modify%20records%20in%20the%20zone%20at%20or%20below%20the%20name%20specified%20in%20the%20name%20field.%20The%20incorrect%20documentation%2C%20however%2C%20indicated%20that%20the%20policy%20would%20be%20restricted%20to%20names%20at%20or%20below%20the%20machine's%20name%20as%20encoded%20in%20the%20Windows%20or%20Kerberos%20principal.%0A%0AFor%20example%2C%20if%20named.conf%20contains%20the%20following%20configuration%20statement%20in%20the%20zone%20%22example.com%22%3A%0A%0Azone%20example.com%20%7B%0A%20%20%20%20%20%20%20%20...%0A%20%20%20%20%20%20%20%20update-policy%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grant%20SUB.EXAMPLE.COM%20krb5-subdomain%20.%20ANY%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%7D%3B%0A%0A...then%20a%20client%20possessing%20a%20valid%20Kerberos%20machine%20principal%20for%20host%2Fmachine.sub.example.com%40SUB.EXAMPLE.COM%20would%20be%20allowed%20to%20update%20any%20record%20at%20or%20below%20%22example.com%22%2C%20whereas%20the%20documentation%20indicated%20that%20updates%20would%20only%20be%20permitted%20at%20or%20below%20%22machine.sub.example.com%22.%20In%20practice%2C%20the%20name%20of%20the%20machine%20encoded%20in%20the%20principal%20is%20not%20checked%20to%20ensure%20that%20it%20matches%20the%20records%20to%20be%20updated.%20The%20update%20policy%20for%20the%20zone%2C%20having%20established%20that%20the%20client%20possesses%20a%20valid%20machine%20principal%20from%20the%20SUB.EXAMPLE.COM%20realm%2C%20simply%20allows%20updates%20to%20all%20records%20within%20the%20zone%20%22example.com%22.%0A%0AThe%20ms-subdomain%20rule%20type%20behaves%20similarly%2C%20but%20for%20Windows%20machine%20principals%20such%20as%20machine%24%40SUB.EXAMPLE.COM%20instead%20of%20Kerberos%20principals.%0A%0AThe%20krb5-subdomain%20and%20ms-subdomain%20rules%20are%20intended%20to%20limit%20updates%20to%20names%20below%20the%20name%20field%20(in%20this%20example%2C%20%22.%22%2C%20which%20covers%20the%20entire%20zone).%20Because%20of%20a%20separate%20bug%20in%20the%20named.conf%20parser%2C%20a%20name%20field%20below%20%22.%22%20could%20not%20be%20configured%20in%20some%20releases.%0A%0AMaintenance%20releases%20of%20BIND%20released%20during%20or%20after%20October%202018%20(9.11.5%20or%20higher%2C%209.12.3%20or%20higher)%20will%20address%20this%20configuration%20bug%2C%20as%20well%20as%20adding%20new%20krb5-selfsub%20and%20ms-selfsub%20rule%20types%20which%20more%20accurately%20implement%20the%20behavior%20that%20the%20ARM%20formerly%20attributed%20to%20krb5-subdomain%20and%20ms-subdomain.&color=brightgreen)

### Description

To provide fine-grained controls over the ability to use Dynamic DNS (DDNS) to update records in a zone, BIND 9 provides a feature called update-policy. Various rules can be configured to limit the types of updates that can be performed by a client, depending on the key used when sending the update request. Unfortunately, some rule types were not initially documented, and when documentation for them was added to the Administrator Reference Manual (ARM) in change #3112, the language that was added to the ARM at that time incorrectly described the behavior of two rule types, krb5-subdomain and ms-subdomain. This incorrect documentation could mislead operators into believing that policies they had configured were more restrictive than they actually were. This affects BIND versions prior to BIND 9.11.5 and BIND 9.12.3.

### POC

#### Reference
No PoCs from references.

#### Github
- https://github.com/ARPSyndicate/cvemon
- https://github.com/HJXSaber/bind9-my
- https://github.com/Maribel0370/Nebula-io
- https://github.com/balabit-deps/balabit-os-8-bind9-libs
- https://github.com/balabit-deps/balabit-os-9-bind9-libs
- https://github.com/krlabs/dnsbind-vulnerabilities
- https://github.com/lekctut/sdb-hw-13-01
- https://github.com/openkylin/bind9-libs
- https://github.com/pedr0alencar/vlab-metasploitable2
- https://github.com/pexip/os-bind9
- https://github.com/pexip/os-bind9-libs
- https://github.com/psmedley/bind-os2

